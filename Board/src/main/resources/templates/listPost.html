<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS only -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" 
integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
<!-- JavaScript Bundle with Popper -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" 
integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
    <title>게시판</title>
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container-fluid">
          <a class="navbar-brand" href="/list">Home</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor03" aria-controls="navbarColor03" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarColor03">
            <ul class="navbar-nav me-auto">
              <li class="nav-item">
                <a class="nav-link" href="#">로그인</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">회원가입</a>
              </li>
            </ul>
              <form th:action="@{|/post/list|}" th:method="get" class="d-flex">
                  <select class="form-select w-auto me-2" type="text" name="searchType">
                      <option>제목</option>
                      <option>제목+내용</option>
                      <option>댓글</option>
                  </select>
                  <input class="form-control me-sm-2" type="text" name="searchText" placeholder="Search">
                  <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
              </form>
          </div>
        </div>
      </nav>

      <div class="container my-3">
        <div class="row my-3">
            <div class="col-6">
                <a href="/postForm" class="btn btn-primary">질문 등록하기</a>
            </div>
        </div>
        
        <table class="table table-hover text-center">
            <thead>
              <tr>
                <th scope="col">번호</th>
                <th scope="col" style="width:50%">제목</th>
                <th scope="col">글쓴이</th>
                <th scope="col">작성일시</th>
              </tr>
            </thead>

            <tbody>
              <tr th:each="postDto : ${postDtoPage}">
                <th th:text="|${postDto.id}|"></th>
                <td>
                    <a th:href="@{|/post/${postDto.id}|}" th:if="${#lists.size(postDto.commentDtoList)} <= 0"
                       th:text="|${postDto.subject}|"></a>
                    <a th:href="@{|/post/${postDto.id}|}" th:if="${#lists.size(postDto.commentDtoList)} > 0"
                       th:text="|${postDto.subject}(${#lists.size(postDto.commentDtoList)})|"></a>
                </td>
                <td>ㅇㅇ(글쓴이)</td>
                <td th:text="${#temporals.format(postDto.createdDate, 'yyyy-MM-dd HH:mm')}"></td>
            </tr>
            </tbody>
          </table>


          <!-- 페이징처리 시작 -->
          <div th:if="${!postDtoPage.isEmpty()}">
              <ul class="pagination justify-content-center">
                  <li class="page-item" th:classappend="${!postDtoPage.hasPrevious} ? 'disabled'">
                      <a class="page-link"
                         th:href="@{|?page=${postDtoPage.number}|}">
                          <span>이전</span>
                      </a>
                  </li>
                  <li th:each="page: ${#numbers.sequence(1, postDtoPage.totalPages)}"
                      th:if="${page >= postDtoPage.number-5 and page <= postDtoPage.number+5}"
                      th:classappend="${page == postDtoPage.number + 1} ? 'active'"
                      class="page-item">
                      <a th:text="${page}" class="page-link" th:href="@{|?page=${page}|}"></a>
                  </li>
                  <li class="page-item" th:classappend="${!postDtoPage.hasNext} ? 'disabled'">
                      <a class="page-link" th:href="@{|?page=${postDtoPage.number+2}|}">
                          <span>다음</span>
                      </a>
                  </li>
              </ul>
          </div>
          <!-- 페이징처리 끝 -->

    </div>
</body>
</html>